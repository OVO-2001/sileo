<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>OVO-2001 · Sileo Repo</title>
  <meta name="description" content="OVO-2001 的 Sileo 越狱源（GitHub Pages）" />

  <style>
    :root{
      --bg0:#070b14;
      --bg1:#081a2a;
      --gl: rgba(255,255,255,.10);
      --gl2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.18);
      --stroke2: rgba(255,255,255,.10);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.66);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --shadow2: 0 12px 30px rgba(0,0,0,.35);
      --r24: 24px;
      --r18: 18px;
      --r14: 14px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "PingFang SC","Microsoft YaHei", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 760px at 15% 15%, rgba(84, 214, 255,.25), transparent 60%),
        radial-gradient(900px 700px at 85% 20%, rgba(255, 120, 210,.22), transparent 55%),
        radial-gradient(980px 880px at 50% 88%, rgba(120, 255, 210,.16), transparent 60%),
        linear-gradient(145deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
      position: relative;
    }

    /* 星空/流星 Canvas 在最底层 */
    #fx{
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
      opacity: .85;
    }

    /* subtle film grain */
    body::before{
      content:"";
      position:fixed; inset:0;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      opacity:.20;
      pointer-events:none;
      mix-blend-mode: overlay;
      z-index: 1;
    }

    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px 16px;
      position: relative;
      z-index: 2; /* 盖在特效上 */
    }

    .shell{
      width:min(920px, 100%);
      border-radius: var(--r24);
      background: linear-gradient(180deg, var(--gl), var(--gl2));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px) saturate(135%);
      -webkit-backdrop-filter: blur(18px) saturate(135%);
      position:relative;
      overflow:hidden;
    }

    .shell::after{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(700px 280px at 18% 0%, rgba(255,255,255,.14), transparent 60%),
        radial-gradient(600px 260px at 82% 18%, rgba(255,255,255,.08), transparent 55%);
      pointer-events:none;
    }

    header{
      position:relative;
      padding:26px 26px 14px;
      display:flex;
      gap:14px;
      align-items:center;
      z-index:1;
    }

    /* 左上角头像：改为源 icon.png */
    .appIcon{
      width:46px; height:46px;
      border-radius:16px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.22);
      box-shadow: var(--shadow2);
      overflow:hidden;
      flex:0 0 auto;
      position: relative;
    }
    .appIcon img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
      transform: translateZ(0);
    }
    /* 轻微高光 */
    .appIcon::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(50px 36px at 28% 18%, rgba(255,255,255,.22), transparent 60%);
      pointer-events:none;
    }

    .title{
      margin:0;
      font-size:20px;
      letter-spacing:.2px;
      line-height:1.15;
    }

    .subtitle{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.4;
    }

    .content{
      position:relative;
      z-index:1;
      padding:0 26px 26px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
    }

    @media (max-width:820px){
      header{padding:22px 18px 12px}
      .content{grid-template-columns:1fr; padding:0 18px 18px}
    }

    .panel{
      border-radius: var(--r18);
      background: rgba(255,255,255,.07);
      border: 1px solid var(--stroke2);
      padding:16px;
    }

    .panel h2{
      margin:0 0 10px;
      font-size:13px;
      letter-spacing:.2px;
      color: rgba(255,255,255,.86);
    }

    .urlBox{
      border-radius: 16px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.14);
      padding:12px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
    }

    .url{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:13px;
      line-height:1.35;
      word-break: break-all;
      color: rgba(255,255,255,.92);
    }

    .mini{
      font-size:12px;
      color:var(--muted);
      margin:10px 0 0;
      line-height:1.55;
    }

    .btnRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:12px;
    }

    .btn{
      appearance:none;
      border:0;
      cursor:pointer;
      padding:10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      color: rgba(255,255,255,.92);
      font-weight:700;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }

    .btn:hover{
      background: rgba(255,255,255,.14);
      border-color: rgba(255,255,255,.22);
      transform: translateY(-1px);
    }
    .btn:active{
      transform: translateY(0px) scale(.98);
    }

    .btn.primary{
      background: linear-gradient(135deg, rgba(84,214,255,.22), rgba(255,120,210,.18));
      border:1px solid rgba(255,255,255,.22);
    }

    .steps{
      margin:0;
      padding-left:18px;
      color: rgba(255,255,255,.82);
      font-size:13px;
      line-height:1.65;
    }
    .steps li{margin:6px 0}

    .chips{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:12px;
    }
    .chip{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.80);
      font-size:13px;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: rgba(255,255,255,.35);
      box-shadow: 0 0 0 3px rgba(255,255,255,.08);
      flex:0 0 auto;
    }

    footer{
      position:relative;
      z-index:1;
      padding:14px 26px 22px;
      border-top:1px solid rgba(255,255,255,.10);
      display:flex;
      justify-content:space-between;
      gap:10px;
      color: rgba(255,255,255,.55);
      font-size:12px;
    }
    @media (max-width:820px){
      footer{padding:14px 18px 18px; flex-direction:column}
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 20px;
      transform: translateX(-50%) translateY(10px);
      padding: 11px 14px;
      border-radius: 16px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.20);
      color: rgba(255,255,255,.92);
      font-size: 13px;
      font-weight: 700;
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      backdrop-filter: blur(18px) saturate(140%);
      -webkit-backdrop-filter: blur(18px) saturate(140%);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 9999;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(0px);
    }

    .modalMask{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease;
      z-index: 9998;
    }
    .modalMask.show{
      opacity: 1;
      pointer-events: auto;
    }
    .modal{
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%) scale(.98);
      width: min(420px, calc(100% - 26px));
      border-radius: 22px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.22);
      box-shadow: 0 22px 80px rgba(0,0,0,.55);
      backdrop-filter: blur(22px) saturate(145%);
      -webkit-backdrop-filter: blur(22px) saturate(145%);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 9999;
      overflow:hidden;
    }
    .modal.show{
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%,-50%) scale(1);
    }
    .modalHead{
      padding: 16px 16px 10px;
      display:flex;
      gap:10px;
      align-items:center;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .modalHead .dot{
      background: rgba(120,255,210,.35);
      box-shadow: 0 0 0 3px rgba(120,255,210,.10);
    }
    .modalTitle{
      margin:0;
      font-size: 14px;
      letter-spacing:.2px;
    }
    .modalBody{
      padding: 14px 16px 16px;
      color: rgba(255,255,255,.82);
      font-size: 13px;
      line-height: 1.6;
    }
    .modalActions{
      padding: 12px 16px 16px;
      display:flex;
      gap:10px;
      justify-content:flex-end;
    }

    /* 减少动态效果时：不渲染流星 */
    @media (prefers-reduced-motion: reduce){
      #fx{ display:none; }
    }
  </style>
</head>

<body>
  <!-- 星空/流星特效 -->
  <canvas id="fx" aria-hidden="true"></canvas>

  <div class="wrap">
    <main class="shell" role="main" aria-label="Sileo Repo">
      <header>
        <div class="appIcon" aria-hidden="true">
          <img src="icon.png" alt="Repo Icon" loading="eager" />
        </div>

        <div>
          <h1 class="title">OVO-2001 · Sileo 越狱源</h1>
          <p class="subtitle">磨砂玻璃风格首页（GitHub Pages）。复制地址后在 Sileo → Sources → Add 添加。</p>
        </div>
      </header>

      <section class="content">
        <div class="panel">
          <h2>源地址</h2>

          <div class="urlBox">
            <div class="url" id="repoUrl">https://ovo-2001.github.io/sileo/</div>
            <button class="btn" id="showModalBtn" type="button">说明</button>
          </div>

          <div class="btnRow">
            <button class="btn primary" id="copyBtn" type="button">复制源地址</button>
            <a class="btn" href="sileo://source/https://ovo-2001.github.io/sileo/" rel="noopener">用 Sileo 打开</a>
            <a class="btn" href="https://github.com/OVO-2001/sileo" target="_blank" rel="noopener">查看仓库</a>
          </div>

          <p class="mini">
            如果 "用 Sileo 打开" 无效：直接复制地址，在 Sileo 里粘贴添加即可。
          </p>

          <div class="chips">
            <div class="chip"><span class="dot"></span>后续你会加入：<b>debs/</b>、<b>Packages</b>、<b>Release</b></div>
            <div class="chip"><span class="dot"></span>页面只是首页，美观用；真正可用源取决于 Packages/Release</div>
          </div>
        </div>

        <aside class="panel">
          <h2>添加教程</h2>
          <ol class="steps">
            <li>打开 Sileo</li>
            <li>进入 Sources（软件源）</li>
            <li>点击右上角 Add（添加）</li>
            <li>粘贴源地址并确认</li>
          </ol>

          <div style="height:12px"></div>

          <h2>小提示</h2>
          <ol class="steps">
            <li>如果你刚开 Pages，需要等 1～2 分钟生效</li>
            <li>建议保持仓库 Public，避免访问受限</li>
          </ol>
        </aside>
      </section>

      <footer>
        <span>© <span id="year"></span> OVO-2001</span>
        <span>Frosted Glass UI · GitHub Pages</span>
      </footer>
    </main>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">已复制</div>

  <div id="mask" class="modalMask" aria-hidden="true"></div>
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modalHead">
      <span class="dot" aria-hidden="true"></span>
      <h3 class="modalTitle" id="modalTitle">提示</h3>
    </div>
    <div class="modalBody">
      这个弹窗和提示条都是网页自定义的"磨砂玻璃"效果，不是系统 alert，所以样式可以完全控制。<br><br>
      下一步如果你要把源变成"真正可安装"，需要上传 deb 并生成 Packages / Packages.gz / Release。
    </div>
    <div class="modalActions">
      <button class="btn" id="closeModalBtn" type="button">关闭</button>
    </div>
  </div>

  <script>
    // year
    document.getElementById("year").textContent = new Date().getFullYear();

    const repoUrl = document.getElementById("repoUrl").textContent.trim();
    const copyBtn = document.getElementById("copyBtn");
    const toast = document.getElementById("toast");

    const mask = document.getElementById("mask");
    const modal = document.getElementById("modal");
    const showModalBtn = document.getElementById("showModalBtn");
    const closeModalBtn = document.getElementById("closeModalBtn");

    function showToast(text){
      toast.textContent = text;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 1200);
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        return true;
      }
    }

    copyBtn.addEventListener("click", async () => {
      await copyText(repoUrl);
      showToast("源地址已复制！");
    });

    function openModal(){
      mask.classList.add("show");
      modal.classList.add("show");
    }
    function closeModal(){
      mask.classList.remove("show");
      modal.classList.remove("show");
    }

    showModalBtn.addEventListener("click", openModal);
    closeModalBtn.addEventListener("click", closeModal);
    mask.addEventListener("click", closeModal);
    document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeModal(); });

    /* =========================
       流星雨/星空特效（Canvas）
       - 性能友好
       - 自动适配 DPR
       - iOS Safari OK
    ========================== */
    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d", { alpha: true });

    let W=0, H=0, DPR=1;
    function resize(){
      DPR = Math.min(2, window.devicePixelRatio || 1);
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);
      canvas.width = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width = W + "px";
      canvas.style.height = H + "px";
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    window.addEventListener("resize", resize, { passive:true });
    resize();

    // 星星
    const stars = [];
    function initStars(){
      stars.length = 0;
      const count = Math.floor(Math.min(220, Math.max(90, (W*H)/12000)));
      for(let i=0;i<count;i++){
        stars.push({
          x: Math.random()*W,
          y: Math.random()*H,
          r: Math.random()*1.6 + 0.2,
          a: Math.random()*0.55 + 0.15,
          tw: Math.random()*0.015 + 0.006
        });
      }
    }
    initStars();

    // 流星
    const meteors = [];
    function spawnMeteor(){
      // 从上方/左上方进入
      const fromTop = Math.random() < 0.55;
      const x = fromTop ? Math.random()*W : -80;
      const y = fromTop ? -50 : Math.random()*H*0.55;
      const len = Math.random()*220 + 140;
      const spd = Math.random()*12 + 10;
      const ang = Math.random()*0.22 + 0.72; // 约 41°~54°
      meteors.push({
        x, y,
        vx: Math.cos(ang)*spd,
        vy: Math.sin(ang)*spd,
        len,
        life: 0,
        max: Math.random()*40 + 34,
        w: Math.random()*1.2 + 0.7
      });
      // 控制数量
      if(meteors.length > 8) meteors.shift();
    }

    // 生成节奏：偶尔来一颗
    let meteorTimer = 0;
    function tickMeteor(dt){
      meteorTimer += dt;
      const interval = 900 + Math.random()*900; // 0.9s~1.8s
      if(meteorTimer > interval){
        meteorTimer = 0;
        if(document.visibilityState === "visible") spawnMeteor();
      }
    }

    // 背景淡淡光晕（跟你原背景相配）
    function drawGlow(){
      const g = ctx.createRadialGradient(W*0.2, H*0.15, 0, W*0.2, H*0.15, Math.min(W,H)*0.65);
      g.addColorStop(0, "rgba(84,214,255,0.10)");
      g.addColorStop(1, "rgba(0,0,0,0)");
      ctx.fillStyle = g;
      ctx.fillRect(0,0,W,H);
    }

    let last = performance.now();
    function loop(now){
      const dt = Math.min(50, now - last);
      last = now;

      ctx.clearRect(0,0,W,H);
      drawGlow();

      // 星星闪烁
      for(const s of stars){
        s.a += (Math.random()-0.5)*s.tw;
        s.a = Math.max(0.08, Math.min(0.75, s.a));
        ctx.globalAlpha = s.a;
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
        ctx.fillStyle = "rgba(255,255,255,1)";
        ctx.fill();
      }
      ctx.globalAlpha = 1;

      tickMeteor(dt);

      // 流星绘制
      for(let i=meteors.length-1;i>=0;i--){
        const m = meteors[i];
        m.life += 1;
        m.x += m.vx;
        m.y += m.vy;

        const t = m.life / m.max; // 0~1
        const alpha = (t < 0.2) ? (t/0.2) : (t > 0.85 ? (1 - (t-0.85)/0.15) : 1);
        const tailX = m.x - m.vx * (m.len/18);
        const tailY = m.y - m.vy * (m.len/18);

        const grad = ctx.createLinearGradient(m.x, m.y, tailX, tailY);
        grad.addColorStop(0, `rgba(255,255,255,${0.95*alpha})`);
        grad.addColorStop(0.35, `rgba(120,255,210,${0.28*alpha})`);
        grad.addColorStop(1, `rgba(255,120,210,0)`);

        ctx.strokeStyle = grad;
        ctx.lineWidth = m.w;
        ctx.lineCap = "round";
        ctx.beginPath();
        ctx.moveTo(m.x, m.y);
        ctx.lineTo(tailX, tailY);
        ctx.stroke();

        // 超出屏幕或寿命结束
        if(m.life > m.max || m.x > W+220 || m.y > H+220){
          meteors.splice(i,1);
        }
      }

      requestAnimationFrame(loop);
    }

    // 页面不可见时降低消耗
    document.addEventListener("visibilitychange", ()=>{
      if(document.visibilityState !== "visible"){
        meteors.length = 0;
      }
    });

    requestAnimationFrame(loop);
  </script>
</body>
</html>
